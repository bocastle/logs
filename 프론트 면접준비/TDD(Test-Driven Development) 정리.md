# TDD(Test-Driven Development) 정리

## 1) 개념
- **TDD**는 테스트를 먼저 작성한 뒤, 테스트를 통과시키는 최소 구현을 하고, 그 다음 리팩터링하는 **Red → Green → Refactor** 사이클을 반복하는 개발 방법론입니다.
- 작성된 테스트가 **요구사항의 실행 가능한 명세** 역할을 하며, 안전한 리팩터링과 회귀(Regression) 방지를 돕습니다.

## 2) 사이클(RED → GREEN → REFACTOR)
1. **Red**: 실패하는 테스트 작성(아직 구현되지 않은 기능/경계/예외를 명시).
2. **Green**: 테스트를 **통과시키기 위한 최소한의 코드**를 작성.
3. **Refactor**: 중복 제거, 설계 개선(테스트는 계속 **초록** 유지).

> 핵심: 작은 단위로 빠르게 반복하며, 요구사항을 명확하게 하고 설계 결정을 늦추되 비용 없이 되돌릴 수 있게 합니다.

## 3) 간단 예시 (Jest + TypeScript)
```ts
// sum.test.ts
import { sum } from './sum';

test('두 수를 더한다', () => {
  expect(sum(2, 3)).toBe(5);
});
```

```ts
// sum.ts (Green 단계의 최소 구현)
export const sum = (a: number, b: number) => a + b;
```

리팩터링 단계에서는 네이밍, 모듈 구조, 중복 제거 등을 진행하되, 테스트는 계속 통과해야 합니다.

## 4) 장점
- **디버깅 시간 단축**: 실패 지점이 명확해 문제 범위를 빠르게 좁힐 수 있습니다.
- **리팩터링 안전망**: 테스트가 **회귀**를 막아 구조 개선을 자신 있게 수행할 수 있습니다.
- **더 나은 설계 유도**: 테스트하기 쉬운 구조(작은 단위, 명확한 책임, 낮은 결합)를 촉진합니다.
- **명세로서의 테스트**: 테스트가 시스템의 기대 동작을 구체적으로 설명합니다.
- **지속 가능한 개발**: 변경 비용을 낮춰 장기 생산성을 높입니다.

## 5) 단점/주의점
- **초기 비용**: 초반 학습/작성 비용이 존재합니다(특히 UI·비동기·복잡한 통합 시나리오).
- **테스트 품질**: 테스트도 코드입니다. **취약한(assertion 느슨함)·과도하게 내부구현에 결합된 테스트**는 유지보수 비용을 키웁니다.
- **과도한 단위 테스트 집착**: 레이어별 균형(E2E/통합/단위) 없이 무작정 단위 테스트만 늘리면 ROI가 떨어질 수 있습니다.

## 6) 프론트엔드 관점 팁
- **단위(Unit)**: 순수 함수, 포맷터, 유틸, 훅(의존 분리된 로직) → Jest/Vitest 권장.
- **컴포넌트 테스트**: 사용자 관점 렌더/상호작용 검증 → **React Testing Library(RTL)** 사용 권장(구현세부 결합 지양).
- **E2E**: 핵심 사용자 플로우(로그인, 결제, 장바구니 등) → **Cypress/Playwright**로 시나리오 테스트.
- **비동기/상태관리**: TanStack Query, Redux 등은 **캐시/상태 전이**를 명세로 삼아 TDD(에러/로딩/성공/리트라이 경계) 수행.
- **접점 정의**: API를 **MSW**(Mock Service Worker) 등으로 모킹해 **네트워크 의존성**을 격리하고, TDD 사이클을 빠르게 유지.

## 7) 언제 특히 효과적일까?
- 복잡한 **도메인 규칙/경계 조건**이 많은 기능.
- **리팩터링/레거시 마이그레이션** 단계.
- 장기간 유지·확장이 예상되는 **핵심 모듈/핵심 플로우**.

## 8) 언제 과한가?
- 일회성 프로토타입, 단순 랜딩/정적 페이지 등 **변경 가능성 낮고 복잡도 낮은** 경우.
- 화면 스파이크(빠른 탐색)가 필요한 매우 초기 단계(다만 핵심 규칙은 TDD로 캡처해두면 좋습니다).

## 9) 실전 체크리스트
- [ ] 실패하는 테스트로 **의도**를 먼저 고정했다(RED).
- [ ] **최소 구현**으로 빠르게 통과시켰다(GREEN).
- [ ] 중복 제거/분리/네이밍 개선 등 **설계 개선**을 했다(REFACTOR).
- [ ] 테스트는 **사용자 관점**을 우선한다(RTL의 `getByRole`, 접근성 쿼리 선호).
- [ ] **비즈니스 규칙**은 UI와 분리해 순수 함수/훅으로 옮겨 **테스트 용이성**을 확보했다.
- [ ] 네트워크/시간/랜덤 등 **비결정성**은 모킹/의존성 주입으로 통제했다.
- [ ] 테스트 실행 속도와 **피드백 루프**를 항상 빠르게 유지했다(캐시, watch 모드).

## 10) 한 줄 요약
**TDD는 요구사항을 테스트라는 실행 가능한 명세로 고정하고, 작은 사이클로 안전하게 구현과 설계를 진화시키는 방법**입니다. 프론트엔드에서는 단위·컴포넌트·E2E의 적절한 균형과 사용자 관점의 테스트가 핵심입니다.
