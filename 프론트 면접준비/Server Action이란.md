# Server Action이란?

Server Action은 **Next.js(App Router)**에서 제공하는 기능으로, **서버에서만 실행되는 함수를 클라이언트(브라우저)에서 안전하게 호출**할 수 있게 해주는 메커니즘입니다.  
기존처럼 별도의 API Route(REST)나 서버를 하나 더 두지 않고도, **폼 제출·버튼 클릭 같은 사용자 동작을 통해 서버 로직(예: DB 작업, 인증, 외부 API 호출)을 직접 실행**할 수 있습니다.

핵심적으로는 다음을 의미합니다.

- **실행 위치**: 서버(Next.js 런타임)에서 실행
- **호출 주체**: 브라우저(클라이언트)가 트리거(폼 제출/이벤트)하여 호출 가능
- **목표**: 클라이언트↔서버 상호작용을 단순화하고, 네트워크/보안/번들 측면의 비용을 줄임

---

## 기본 사용 방법

Server Action은 함수 파일 또는 함수 선언부에 `"use server"` 디렉티브를 붙여 **“이 함수는 서버에서만 실행된다”**를 선언합니다.

```ts
"use server";

export async function createReviewAction(formData: FormData) {
  const content = formData.get("content");
  // 1) 검증
  // 2) DB 저장
  // 3) 필요 시 revalidatePath / redirect 등
}
```

폼에서 `action`에 함수를 넘기면, 폼 제출 시 Server Action이 실행됩니다.

```tsx
<form action={createReviewAction}>
  <textarea name="content" required />
  <button type="submit">Submit</button>
</form>
```

> 폼 기반 호출은 **JS가 아직 로드되지 않은 상태**에서도 동작할 수 있다는 점이 장점입니다(점진적 향상).

---

## Server Action의 장점

### 1) API 엔드포인트를 줄여 개발 흐름 단순화

기존에는 “클라이언트 → API 호출 → 서버 처리” 경로가 필요했지만, Server Action을 쓰면 **UI 동작이 곧 서버 로직 호출**로 연결됩니다.

- CRUD 폼 처리, 간단한 서버 업데이트 작업에서 생산성 증가
- API 라우팅/DTO/컨트롤러 계층이 과도하게 늘어나는 것을 방지

### 2) 보안 및 번들 최적화

Server Action 로직은 **클라이언트 번들로 포함되지 않기 때문에**, 아래와 같은 이점이 있습니다.

- DB 접속 정보, 시크릿, 내부 로직을 브라우저에 노출하지 않음
- 클라이언트 JS 번들 크기 감소에 기여 가능

### 3) 네트워크 비용 감소(상황에 따라)

“API를 한번 더 거치는 구조”가 줄어들어, 설계에 따라 **요청/응답 오버헤드가 단순화**될 수 있습니다.

---

## Server Action을 사용할 때의 주의 사항/고려 사항

### 1) 서버 의존성 증가

Server Action은 서버에서 실행되므로, **서버 성능/가용성이 곧 사용자 경험에 직접 영향**을 줍니다.

- 서버가 느리거나 장애가 나면 액션 처리 지연/실패
- 서버리스 환경에서는 콜드스타트/실행시간 제한을 고려해야 함

### 2) 오류 처리 및 UX 설계

폼 제출/액션 호출 시 실패했을 때 사용자가 “무슨 일이 일어났는지” 알 수 있도록:

- 에러 메시지 노출 방식(인라인/토스트)
- 재시도 전략
- 낙관적 업데이트가 필요한지 여부

를 미리 설계하는 것이 좋습니다.

### 3) 캐시/재검증(데이터 최신화) 전략

Server Action으로 데이터 변경 후, 화면에 최신 값이 반영되도록:

- `revalidatePath`, `revalidateTag` 같은 재검증
- 혹은 클라이언트 측 상태/캐시(TanStack Query 등)와의 동기화

를 함께 고려해야 합니다.

### 4) “무엇을 Server Action으로 둘 것인가” 기준

모든 로직을 Server Action으로 옮기는 것이 항상 좋은 것은 아닙니다.

- **브라우저에서 즉시 반응해야 하는 UI 로직**은 클라이언트 컴포넌트에
- **권한/보안/DB 작업/서버에서만 가능한 작업**은 Server Action에

두는 식으로 역할을 분리하는 것이 일반적입니다.

---

## 언제 쓰면 좋은가?

- 폼 제출 기반의 생성/수정/삭제(게시글 작성, 댓글 등록, 설정 저장 등)
- 서버에서만 가능한 로직(DB, 시크릿 키 필요, 내부 네트워크 호출)
- API 라우트를 따로 만드는 것이 과한 “간단한 서버 작업”들

---

## 한 줄 요약

Server Action은 **브라우저에서 트리거되지만 서버에서 실행되는 함수**로,  
**API 계층을 줄이면서도 보안과 DX(개발자 경험)를 개선**하는 Next.js의 서버 중심 기능입니다.
