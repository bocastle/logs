# NAT(Network Address Translation)를 사용하는 이유 정리

## 1) IPv4 공인 IP 주소 부족 문제 해결

- **사설 IP(Private IP)** 는 조직/가정 내부 네트워크에서만 유효하며, 외부 인터넷에서 라우팅되지 않습니다.
- 내부 호스트들이 모두 **공인 IP(Public IP)** 를 직접 갖게 하면 공인 IP가 빠르게 고갈됩니다.
- NAT는 내부의 여러 사설 IP를 **소수의 공인 IP(대개 1개)** 로 “대신” 통신하게 만들어 **주소 절약** 효과를 얻습니다.

## 2) 사설 네트워크의 인터넷 통신 가능

- 내부 호스트가 외부로 패킷을 보낼 때, 라우터/게이트웨이가 **송신지 IP(및 필요 시 포트)** 를 공인 IP로 변환합니다.
- 외부에서 돌아오는 응답 패킷은 NAT 장비가 변환 테이블을 보고 **다시 내부 사설 IP(및 포트)** 로 되돌려 전달합니다.
- 결과적으로 내부 호스트는 사설 IP만 가지고도 인터넷과 통신할 수 있습니다.

## 3) 기본적인 은닉/격리 효과(보안·운영 측면)

- 외부에서는 내부 사설 IP 구조가 보이지 않고, 일반적으로 **인바운드(외부→내부) 연결은 명시적으로 포트포워딩 등을 설정해야만** 들어올 수 있습니다.
- “NAT 자체가 방화벽”은 아니지만, 외부에서 내부 호스트로의 직접 접근을 어렵게 만들어 **공격면 감소** 및 **내부 주소 체계 은닉**에 도움이 됩니다.

## 4) NAPT(PAT)로 ‘다대일’ 매핑 실현 (포트 기반 NAT)

공인 IP를 1:1로 매핑하면 여전히 공인 IP가 많이 필요하므로, 실무에서는 대부분 **NAPT(Network Address Port Translation)** 를 사용합니다.

- NAT 테이블이 **(사설 IP, 사설 포트) ↔ (공인 IP, 공인 포트)** 형태로 매핑을 유지합니다.
- 내부 호스트 여러 대가 같은 공인 IP를 공유해도, **포트 번호를 다르게 할당**하여 세션을 구분합니다.

예시)

- 192.168.10.2:8000 → 1.2.3.4:8001
- 192.168.10.3:8000 → 1.2.3.4:8002  
  같은 공인 IP(1.2.3.4)를 쓰지만 공인 포트가 달라 **충돌 없이 동시 통신**이 가능합니다.

## 5) NAT 사용 시 함께 알아둘 점(한계)

- 외부에서 내부로 “새 연결”을 만들려면 보통 **포트포워딩/정책 설정**이 필요합니다.
- P2P/VoIP/WebRTC 같은 시나리오에서는 NAT 통과(STUN/TURN/ICE) 이슈가 생길 수 있습니다.
- end-to-end 관점에서 주소 투명성이 깨지므로 트러블슈팅이 복잡해질 수 있습니다.
